import{a as w,b as _}from"./chunk-GPLPZG6S.js";import{b as $e,c as Ue,d as ze}from"./chunk-PZRUESVB.js";import"./chunk-5K3FVEWN.js";import{a as Xe,b as Be}from"./chunk-RA4VD5ZQ.js";import{A as Ee,B as Ie,C as Te,D as Ae,E as Le,F as ke,G as Ne,H as Re,I as P,J as X,K as Ve,L as je,M as B,N as $,O as H,P as y,Q as Oe,R as Pe,X as He,Y as We,a as ce,da as Ge,ea as qe,h as pe,j as de,k as R,l as fe,m as O,t as Me,u as De,v as Se,w as ve,x as xe,y as ye,z as we}from"./chunk-KCRUWNJC.js";import"./chunk-2DMVZMIS.js";import{b as V,d as x,f as j,g as ue,i as ge,j as he,k as be,l as Ce,m as Fe,p as _e}from"./chunk-CY7E6JQX.js";import{k as K}from"./chunk-UCASUQWF.js";import"./chunk-CARY4E7O.js";import{$b as D,Bc as I,Cc as T,Ha as u,Hb as d,Ia as g,Mb as s,Pb as J,Sb as Z,Sc as le,Tb as ee,Ub as te,Vb as o,Wb as a,Xb as h,Yb as C,Zb as b,ca as Y,cc as f,ec as E,lb as z,ma as L,md as N,oc as S,od as me,pb as m,pc as r,pd as se,qb as c,qc as ie,rc as v,uc as ae,vc as ne,wc as oe,x as Q,xa as M,ya as k,zc as re}from"./chunk-UI7FGHJG.js";function ot(i,e){if(i&1&&(o(0,"mat-option",8),r(1),a()),i&2){let t=e.$implicit;s("value",t),m(),ie(t)}}function rt(i,e){i&1&&(C(0)(1,14),o(2,"div",15)(3,"div",16)(4,"mat-form-field",4)(5,"mat-label"),r(6,"Fleet Manager Name"),a(),h(7,"input",17),a()(),o(8,"div",16)(9,"mat-form-field",4)(10,"mat-label"),r(11,"Email"),a(),h(12,"input",18),a()()(),o(13,"mat-form-field",4)(14,"mat-label"),r(15,"Phone"),a(),h(16,"input",19),a(),b()())}var A=class i{constructor(e,t,n,l,p){this.data=e;this.formBuilder=t;this._FleetService=n;this.store=l;this.MatDialogRef=p;this.checkStatus(),this.editId=this.data.editId}fleetForm;fleetManagersList;fleetMList;filteredOptions;fleetReadById$;isEditMode;editId="";ngOnInit(){this.createFleetForm(),this.isEditMode&&(this.store.getFleetDataById(this.editId),this.store.FleetDataById$.subscribe(e=>{console.log(e),this.fleetForm.patchValue({name:e.fleetname,fleetManagerName:"Other",fleetManager:{name:e.fleetManagerName,email:e.fleetManagerEmail,phone:e.fleetManagerPhone}})})),this.store.FleetManagers$.subscribe(e=>{this.fleetManagersList=e,this.fleetMList=e.map(t=>t.name),console.log(this.fleetMList),this.filteredOptions=this.fleetForm.controls.fleetManagerName.valueChanges.pipe(Y(""),Q(t=>t==""||this.fleetMList.includes(t)?this.fleetMList:(console.log("h"),this._filter(t||"")))),console.log(this.filteredOptions)})}createFleetForm(){this.fleetForm=this.formBuilder.group({name:["",[x.required]],fleetManagerName:[""],fleetManager:this.formBuilder.group({name:["",[x.required]],email:["",[x.required,x.email]],phone:["",[x.required]]})})}createFleet(){let e=this.fleetForm.value;if(this.isEditMode){let t={fleetname:e.name,fleetManagerName:e.fleetManager.name,fleetManagerEmail:e.fleetManager.email,fleetManagerPhone:e.fleetManager.phone,trucksCount:0,trailersCount:0,containersCount:0},n={updId:this.editId,updFleetData:t};this.store.updateSingleFleetData(n);let l={api:!0};this.MatDialogRef.close(l)}else{let t={fleetname:e.name,fleetManagerName:e.fleetManager.name,fleetManagerEmail:e.fleetManager.email,fleetManagerPhone:e.fleetManager.phone,trucksCount:0,trailersCount:0,containersCount:0};if(this.store.addSingleFleetData(t),e.fleetManagerName=="Other"){let n={name:e.fleetManager.name,email:e.fleetManager.email,phone:e.fleetManager.phone};this.store.addSingleFleetManager(n);let l={api:!0};this.MatDialogRef.close(l)}else{let n={api:!0};this.MatDialogRef.close(n)}}}fleetManagerSelection(e){console.log("change"),this.fleetForm.get("fleetManager")?.reset(),this.store.getSingleFleetManager(e.option.value),this.store.SingleFleetManager$.subscribe(t=>{console.log(t),this.fleetForm.controls.fleetManager.patchValue(t[0])})}_filter(e){let t=e.toLowerCase();return this.fleetManagersList.filter(n=>n.name.toLowerCase().includes(t)).map(n=>n.name)}checkStatus(){this.isEditMode=!!this.data.editMode}closeDialog(){let e={api:!1};this.MatDialogRef.close(e)}static \u0275fac=function(t){return new(t||i)(c(X),c(_e),c(w),c(_),c(P))};static \u0275cmp=M({type:i,selectors:[["app-add-fleet"]],decls:25,vars:6,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],[1,"fleet",3,"ngSubmit","formGroup"],[1,"mat-typography"],[1,"example-full-width"],["matInput","","placeholder","Name","formControlName","name"],["type","text","aria-label","Fleet Manager","matInput","","formControlName","fleetManagerName",3,"matAutocomplete"],[3,"optionSelected"],[3,"value"],["value","Other"],[4,"ngIf"],["align","end"],["mat-stroked-button","","type","button",1,"btn-outline-danger",3,"click"],["mat-raised-button","","type","submit",3,"disabled"],["formGroupName","fleetManager"],[1,"row"],[1,"col-6"],["matInput","","placeholder","Fleet Manager Name","formControlName","name"],["matInput","","placeholder","Email","formControlName","email"],["matInput","","mask","(XXX) XXX-XXXX","placeholder","(XXX) XXX-XXXX","formControlName","phone"]],template:function(t,n){if(t&1){let l=D();o(0,"h2",1),r(1,"CREATE FLEET"),a(),o(2,"form",2),f("ngSubmit",function(){return u(l),g(n.createFleet())}),o(3,"mat-dialog-content",3)(4,"mat-form-field",4)(5,"mat-label"),r(6,"First name"),a(),h(7,"input",5),a(),o(8,"mat-form-field",4)(9,"mat-label"),r(10,"Fleet Manager"),a(),h(11,"input",6),o(12,"mat-autocomplete",7,0),f("optionSelected",function(F){return u(l),g(n.fleetManagerSelection(F))}),ee(14,ot,2,2,"mat-option",8,Z),I(16,"async"),o(17,"mat-option",9),r(18,"Other"),a()()(),d(19,rt,17,0,"ng-container",10),a(),o(20,"mat-dialog-actions",11)(21,"button",12),f("click",function(){return u(l),g(n.closeDialog())}),r(22,"Cancel"),a(),o(23,"button",13),r(24,"Save"),a()()()}if(t&2){let l=S(13);m(2),s("formGroup",n.fleetForm),m(9),s("matAutocomplete",l),m(3),te(T(16,4,n.filteredOptions)),m(5),s("ngIf",n.fleetForm.controls.fleetManagerName.value=="Other"),m(4),s("disabled",!n.fleetForm.valid)}},dependencies:[N,he,V,j,ue,be,Fe,Ce,R,pe,y,O,B,H,$,ce,He,We,Be,me],styles:[`.fleet .mat-mdc-form-field{width:100%!important}.fleet .mat-mdc-outlined-button:not(:disabled){color:#eb5e55}.fleet .btn-outline-danger{border-color:#eb5e55!important}.fleet .mat-mdc-raised-button:not(:disabled){background-color:#01aae4;color:#f8f9fc}.fleet .mat-mdc-raised-button:not(:disabled) .primary-fab-btn{border:1px solid #01AAE4}
`],encapsulation:2})};var G=class i{constructor(e,t,n,l){this.data=e;this._FleetService=t;this.store=n;this.matDialogRef=l;this.delId=e.customerId}delId;DeleteFleet(){this.store.deleteSingleFleetData(this.delId);let e={api:!0};this.matDialogRef.close(e)}static \u0275fac=function(t){return new(t||i)(c(X),c(w),c(_),c(P))};static \u0275cmp=M({type:i,selectors:[["app-confirmation"]],decls:10,vars:5,consts:[["mat-dialog-title",""],[1,"my-4","text-center"],["align","end"],["mat-stroked-button","","type","button",3,"mat-dialog-close"],["mat-stroked-button","","type","button",3,"click"]],template:function(t,n){t&1&&(o(0,"h4",0),r(1,"Delete Fleet"),a(),o(2,"mat-dialog-content")(3,"h5",1),r(4,"Are you sure you want to delete this Fleet ?"),a()(),o(5,"mat-dialog-actions",2)(6,"button",3),r(7,"Cancel"),a(),o(8,"button",4),f("click",function(){return n.DeleteFleet()}),r(9,"Delete"),a()()),t&2&&(m(6),J("mx-2"),s("mat-dialog-close",!1),m(2),J("mx-2"))},dependencies:[y,je,B,H,$]})};var lt=()=>["noDataFound"];function mt(i,e){if(i&1){let t=D();o(0,"button",34),f("click",function(){u(t);let l=E(),p=S(10);return p.value="",g(l.pageRefresh("searchReset"))}),o(1,"span",35),r(2,"close"),a()()}}function st(i,e){i&1&&(o(0,"th",36),r(1," Fleet "),a())}function ct(i,e){if(i&1&&(o(0,"td",37),r(1),a()),i&2){let t=e.$implicit;m(),v(" ",t.fleetname," ")}}function pt(i,e){i&1&&(o(0,"th",36),r(1," Fleet Manager "),a())}function dt(i,e){if(i&1&&(o(0,"td",38),r(1),a()),i&2){let t=e.$implicit;m(),v(" ",t.fleetManagerName," ")}}function ft(i,e){i&1&&(o(0,"th",36),r(1," Trucks "),a())}function ut(i,e){if(i&1&&(o(0,"td",38),r(1),a()),i&2){let t=e.$implicit;m(),v(" ",t.trucksCount," ")}}function gt(i,e){i&1&&(o(0,"th",36),r(1," Trailers "),a())}function ht(i,e){if(i&1&&(o(0,"td",38),r(1),a()),i&2){let t=e.$implicit;m(),v(" ",t.trailersCount," ")}}function bt(i,e){i&1&&(o(0,"th",36),r(1," Conainers "),a())}function Ct(i,e){if(i&1&&(o(0,"td",38),r(1),a()),i&2){let t=e.$implicit;m(),v(" ",t.containersCount," ")}}function Ft(i,e){i&1&&(o(0,"th",36),r(1," Action "),a())}function _t(i,e){if(i&1){let t=D();o(0,"td",38)(1,"button",39),f("click",function(){let l=u(t).$implicit,p=E();return g(p.editFleet(l.id))}),h(2,"span",40),I(3,"icon"),a(),o(4,"button",39),f("click",function(){let l=u(t).$implicit,p=E();return g(p.deleteFleet(l.id))}),h(5,"span",40),I(6,"icon"),a()()}i&2&&(m(2),s("innerHTML",T(3,2,"tableActionEdit"),z),m(3),s("innerHTML",T(6,4,"tableActionDelete"),z))}function Mt(i,e){i&1&&h(0,"tr",41)}function Dt(i,e){i&1&&h(0,"tr",42)}function St(i,e){i&1&&(o(0,"td",43)(1,"p",44),r(2," No Data Found... "),a()())}function vt(i,e){if(i&1&&h(0,"tr",45),i&2){let t=E();s("hidden",t.isDataFound)}}var U=class i{constructor(e,t,n,l){this.dialog=e;this._FleetService=t;this.store=n;this.cdRef=l}length;AllFleetsData=[];FinalDataShow=[];searchString="";FilterData;limit=10;currentPage=1;isDataFound=!0;fleets$;searchValue="";dataSource;displayedColumns=["Fleet","Fleet Manager","Trucks","Trailers","Conainers","Action"];ngOnInit(){console.log("9"),this.store.loadAllFleetManagers(),this.store.loadAllFleets(),this.fleets$=this.store.FleetData$,this.fleets$.subscribe(e=>{e.length!=0&&this.UpdateTableData()})}UpdateTableData(){this.fleets$.subscribe(e=>{e.length!=0&&(this.AllFleetsData=e,this.length=e.length,this.ShowDataAccordingPage())})}ShowDataAccordingPage(){console.log(this.AllFleetsData),console.log(this.currentPage,this.limit),this.FinalDataShow=this.AllFleetsData.slice((this.currentPage-1)*this.limit,this.currentPage*this.limit),console.log(this.FinalDataShow),this.dataSource=new Re(this.FinalDataShow),this.AllFleetsData.length!=0?this.isDataFound=!0:this.isDataFound=!1,this.cdRef.detectChanges()}paginationChange(e){this.currentPage=e.currentPage,this.limit=e.limit,console.log(this.currentPage,this.limit),this.ShowDataAccordingPage()}pageRefresh(e){this.UpdateTableData()}tableSearching(e){console.log(e),this.fleets$.subscribe(t=>{this.AllFleetsData=t,console.log(t),t&&(this.searchString=e.toLocaleLowerCase().trim().replace(/\s/g,""),this.FilterData=this.AllFleetsData.filter(n=>{if(n.fleetname.toLowerCase().trim().replace(/\s/g,"").startsWith(this.searchString))return n}),console.log(this.FilterData),e?(this.AllFleetsData=this.FilterData,this.length=this.FilterData.length,this.ShowDataAccordingPage()):this.UpdateTableData())})}createFleet(){this.dialog.open(A,{maxWidth:"100%",minWidth:"40%",width:"40%",autoFocus:!1,disableClose:!0,data:{editMode:!1}}).afterClosed().subscribe(t=>{t.api&&this.UpdateTableData()})}editFleet(e){this.dialog.open(A,{maxWidth:"100%",minWidth:"40%",width:"40%",autoFocus:!1,disableClose:!0,data:{editMode:!0,editId:e}}).afterClosed().subscribe(n=>{n.api&&this.UpdateTableData()})}deleteFleet(e){this.dialog.open(G,{maxWidth:"500px",minWidth:"60%",width:"500px",data:{customerId:e}}).afterClosed().subscribe(n=>{n.api&&this.UpdateTableData()})}static \u0275fac=function(t){return new(t||i)(c(Ve),c(w),c(_),c(le))};static \u0275cmp=M({type:i,selectors:[["app-fleet-list"]],decls:52,vars:11,consts:[["search",""],[1,"main"],[1,"container-fluid","page-header"],[1,"row","m-0"],[1,"col-6","px-1"],[1,"d-flex","align-items-center"],[1,"m-0"],[1,"ms-3"],[1,"example-full-width"],["placeholder","Search Fleet","type","text","matInput","",3,"ngModelChange","keyup","ngModel"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["matSuffix",""],[1,"d-flex","justify-content-end","align-items-center"],["mat-raised-button","",3,"click"],["mat-mini-fab","",1,"primary-fab-btn","ms-3"],[1,"page-content"],["tabindex","0",1,"example-container","mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","Fleet","sticky",""],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","primary-text",4,"matCellDef"],["matColumnDef","Fleet Manager"],["mat-cell","",4,"matCellDef"],["matColumnDef","Trucks"],["matColumnDef","Trailers"],["matColumnDef","Conainers"],["matColumnDef","Action"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["matColumnDef","noDataFound"],["mat-cell","","colspan","8",4,"matFooterCellDef"],["mat-footer-row","",3,"hidden",4,"matFooterRowDef"],[1,"pagination-wraper"],[3,"change","moduleName","totalRecords","length"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"material-icons"],["mat-header-cell",""],["mat-cell","",1,"primary-text"],["mat-cell",""],["mat-icon-button","",3,"click"],[3,"innerHTML"],["mat-header-row",""],["mat-row",""],["mat-cell","","colspan","8"],[1,"text-center","mt-4"],["mat-footer-row","",3,"hidden"]],template:function(t,n){if(t&1){let l=D();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h2",6),r(6,"Fleets"),a(),o(7,"div",7)(8,"mat-form-field",8)(9,"input",9,0),oe("ngModelChange",function(F){return u(l),ne(n.searchValue,F)||(n.searchValue=F),g(F)}),f("keyup",function(){u(l);let F=S(10);return g(n.tableSearching(F.value))}),a(),d(11,mt,3,0,"button",10),o(12,"mat-icon",11),r(13,"search"),a()()()()(),o(14,"div",4)(15,"div",12)(16,"button",13),f("click",function(){return u(l),g(n.createFleet())}),r(17,"Create"),a(),o(18,"button",14)(19,"mat-icon"),r(20,"sync"),a()()()()()(),o(21,"div",15)(22,"section",16)(23,"table",17),C(24,18),d(25,st,2,0,"th",19)(26,ct,2,1,"td",20),b(),C(27,21),d(28,pt,2,0,"th",19)(29,dt,2,1,"td",22),b(),C(30,23),d(31,ft,2,0,"th",19)(32,ut,2,1,"td",22),b(),C(33,24),d(34,gt,2,0,"th",19)(35,ht,2,1,"td",22),b(),C(36,25),d(37,bt,2,0,"th",19)(38,Ct,2,1,"td",22),b(),C(39,26),d(40,Ft,2,0,"th",19)(41,_t,7,6,"td",22),b(),d(42,Mt,1,0,"tr",27)(43,Dt,1,0,"tr",28),o(44,"tbody"),C(45)(46,29),d(47,St,3,0,"td",30),b(),d(48,vt,1,1,"tr",31),b(),a()()(),o(49,"div",32),C(50),o(51,"app-custom-pagination",33),f("change",function(F){return u(l),g(n.paginationChange(F))}),a(),b(),a()()()}if(t&2){let l=S(10);m(9),ae("ngModel",n.searchValue),m(2),s("ngIf",l.value),m(12),s("dataSource",n.dataSource),m(19),s("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),m(),s("matRowDefColumns",n.displayedColumns),m(5),s("matFooterRowDef",re(10,lt)),m(3),s("moduleName","Fleets")("totalRecords",n.length)("length",n.length)}},dependencies:[N,V,j,ge,R,de,fe,y,Pe,Oe,O,De,ve,Ie,ye,Se,Ae,xe,Te,we,Ee,Le,Ne,ke,$e,Me],styles:[`.main{height:calc(100vh - 70px);overflow:auto}.main .page-header{padding:16px 20.8px!important}.main .page-header .mat-mdc-form-field-infix{min-height:30px!important;padding:5px 0!important;width:268px!important}.main .page-header .mat-mdc-form-field-infix .mat-mdc-form-field-input-control{font-size:20px!important}.main .page-header .mat-mdc-form-field-infix .mdc-text-field__input:focus{outline:none!important}.main .page-header .mat-mdc-form-field-subscript-wrapper{display:none}.main .page-header .mat-mdc-raised-button:not(:disabled){background-color:#01aae4;color:#f8f9fc}.main .page-header .mat-mdc-raised-button:not(:disabled) .primary-fab-btn{border:1px solid #01AAE4}.main .page-content{padding:0 20.8px}.main .page-content .example-container{min-height:calc(100vh - 142px);border-radius:15px!important}.main .page-content table{width:100%;border-radius:15px 15px 0 0!important}.main .page-content .mat-mdc-table thead{background-color:#0d4571!important;border-radius:15px 15px 0 0!important}.main .page-content .mat-mdc-table thead tr th:first-child{border-radius:15px 0 0!important}.main .page-content .mat-mdc-table thead tr th:last-child{border-radius:0 15px 0 0}.main .page-content .mat-mdc-header-row{color:#fff!important}.main .page-content .mat-mdc-table tbody tr:nth-child(odd){background-color:#f5f9fb!important}.main .page-content .mat-mdc-table tbody:nth-child(2n){background-color:#fff!important}.main .page-content .primary-text{color:#01aae4!important}
`],encapsulation:2})};var xt=[{path:"",component:U}],q=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=k({type:i});static \u0275inj=L({imports:[K.forChild(xt),K]})};var et=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=k({type:i});static \u0275inj=L({providers:[_,Xe()],imports:[se,q,Ge,Ue,qe,ze]})};export{et as FleetModule};
